@startuml
!include style.puml
skinparam arrowThickness 1.1
skinparam arrowColor MODEL_COLOR
skinparam classBackgroundColor MODEL_COLOR

package Model <<Rectangle>> {
    Class "<<interface>>\nModel" as Model
    Class ModelManager

    package #line:white {
        package StudentBook <<Rectangle>> {
            Class "<<interface>>\nReadOnlyStudentBook" as ReadOnlyStudentBook
            Class StudentBook
            Class UniqueStudentsList
            Class Student

            Class Name
            Class Address
            Class Email
            Class Phone
            Class Tag

            StudentBook -down-> UniqueStudentsList
            UniqueStudentsList --> "all ~*" Student

            Student *--> Name
            Student *--> Phone
            Student *--> Email
            Student *--> Address
            Student *--> "*" Tag
        }

        package UserPrefs <<Rectangle>> {
            Class "<<interface>>\nReadOnlyUserPrefs" as ReadOnlyUserPrefs
            Class UserPrefs

            Class HiddenUserPref #FFFFFF
            HiddenUserPref -up[hidden]- UserPrefs
        }

        ReadOnlyStudentBook -up[hidden]- UserPrefs
    }

    package LessonBook <<Rectangle>> {
        Class "<<interface>>\nReadOnlyLessonBook" as ReadOnlyLessonBook
        Class LessonBook
        Class ConsistentLessonsList
        Class Lesson

        Class LessonName
        Class Subject
        Class LessonAddress
        Class DateTimeSlot
        Class EnrolledStudents

        LessonBook -down-> ConsistentLessonsList
        ConsistentLessonsList --> "~* all" Lesson

        Lesson *--> LessonName
        Lesson *--> Subject
        Lesson *--> LessonAddress
        Lesson *--> DateTimeSlot
        Lesson *--> EnrolledStudents
    }
}

LessonBook .up.|> ReadOnlyLessonBook
StudentBook .up.|> ReadOnlyStudentBook
ModelManager .up.|> Model
UserPrefs .up.|> ReadOnlyUserPrefs

Model .left.> ReadOnlyStudentBook
Model .left.> ReadOnlyUserPrefs
Model .right.> ReadOnlyLessonBook
ModelManager -right-> "1" StudentBook
ModelManager -right-> "1" LessonBook
ModelManager -left-> "1" UserPrefs
ModelManager -right-> "~* filtered" Student
ModelManager -right-> "filtered ~*" Lesson

Class HiddenOutside1 #FFFFFF
HiddenOutside1 ..> Model

Class HiddenOutside2 #FFFFFF
HiddenOutside2 .[hidden].> Student

ReadOnlyLessonBook -right[Hidden]- ReadOnlyUserPrefs
ReadOnlyStudentBook -left[Hidden]- ReadOnlyUserPrefs

@enduml
